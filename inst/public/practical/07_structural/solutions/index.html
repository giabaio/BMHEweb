<!DOCTYPE html><html lang="en-us" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.3.0 for Hugo" />
  

  
  









  




  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Ubuntu:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&family=Inconsolata:wght@400;500;600;700&display=swap&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&family=Inconsolata:wght@400;500;600;700&display=swap&display=swap" media="print" onload="this.media='all'">
    
  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Gianluca Baio" />

  
  
  
    
  
  <meta name="description" content="The first thing we do is loading and analysing the “base-case” model, which is stored in the object statins_base.Rdata and the “robust” version of the model, stored in statins_HC.Rdata." />

  
  <link rel="alternate" hreflang="en-us" href="/practical/07_structural/solutions/" />

  
  
  
    <meta name="theme-color" content="#1565c0" />
  

  
  
    
    <script src="/js/mathjax-config.js"></script>
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.f1ecf783c14edc00c9320c205831ad8e.css" media="print" onload="this.media='all'">

  
  
  
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.1/css/academicons.min.css" integrity="sha512-b1ASx0WHgVFL5ZQhTgiPWX+68KjS38Jk87jg7pe+qC7q9YkEtFq0z7xCglv7qGIs/68d3mAp+StfC8WKC5SSAg==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    
    
    
    
      
      
    
    
    

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
      
    

    
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.css" integrity="sha512-1xoFisiGdy9nvho8EgXuXvnpR5GAMSjFwp40gSRE3NwdUdIMIKuPa7bqoUhLD0O/5tPNhteAsE5XyyMi5reQVA==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.3ef10ad94e43ba7ad3f08b0b007578ae.css" />

  



  

  

  




  
  
  

  

  
    <link rel="manifest" href="/manifest.webmanifest" />
  

  <link rel="icon" type="image/png" href="/media/icon_hu62751289ff52b250e581ec75f909b74a_9702_32x32_fill_lanczos_center_3.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_hu62751289ff52b250e581ec75f909b74a_9702_180x180_fill_lanczos_center_3.png" />

  <link rel="canonical" href="/practical/07_structural/solutions/" />

  
  
  
  
  
  
  
  
    
    
  
  

  
  
    
    
  
  <meta property="twitter:card" content="summary" />
  
  <meta property="og:site_name" content="Bayesian methods in health economics" />
  <meta property="og:url" content="/practical/07_structural/solutions/" />
  <meta property="og:title" content="Practical 7. PSA to structural uncertainty — SOLUTIONS | Bayesian methods in health economics" />
  <meta property="og:description" content="The first thing we do is loading and analysing the “base-case” model, which is stored in the object statins_base.Rdata and the “robust” version of the model, stored in statins_HC.Rdata." /><meta property="og:image" content="/media/logo_hu1963fc62d5b8fe503cce6274f5cb00c3_9765_300x300_fit_lanczos_3.png" />
    <meta property="twitter:image" content="/media/logo_hu1963fc62d5b8fe503cce6274f5cb00c3_9765_300x300_fit_lanczos_3.png" /><meta property="og:locale" content="en-us" />
  
    
      <meta
        property="article:published_time"
        content="2021-01-10T00:00:00&#43;00:00"
      />
    
    <meta property="article:modified_time" content="2022-06-22T10:00:00&#43;00:00">
  

  



  

  

  





  <title>Practical 7. PSA to structural uncertainty — SOLUTIONS | Bayesian methods in health economics</title>
</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="300078a95ed7b094f1be100614c4d13d" >

  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.da42964e270e05a6063fbca894d7ccff.js"></script>

  




  <div class="page-header">
    











  


<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container-xl">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/"><img src="/media/logo_hu1963fc62d5b8fe503cce6274f5cb00c3_9765_0x70_resize_lanczos_3.png" alt="Bayesian methods in health economics"
          
          ></a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/"><img src="/media/logo_hu1963fc62d5b8fe503cce6274f5cb00c3_9765_0x70_resize_lanczos_3.png" alt="Bayesian methods in health economics"
        
        ></a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-end" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#timetable"><span>Timetable</span></a>
        </li>

        
        

        
        <li class="nav-item dropdown">
          <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>Slides</span><span class="caret"></span>
          </a>
          <div class="dropdown-menu">
            
              <a class="dropdown-item" href="/slides/01_Intro"><span>Introduction</span></a>
            
              <a class="dropdown-item" href="/slides/02_MCMC"><span>Bayesian computation</span></a>
            
              <a class="dropdown-item" href="/slides/03_Intro_HE"><span>Introduction to Health Economics</span></a>
            
              <a class="dropdown-item" href="/slides/04_ILD"><span>Individual level data</span></a>
            
              <a class="dropdown-item" href="/slides/05_ALD"><span>Aggregated level data</span></a>
            
              <a class="dropdown-item" href="/slides/06_NMA"><span>Network meta-analysis</span></a>
            
              <a class="dropdown-item" href="/slides/07_Model_uncertainty"><span>Model error and structural analysis</span></a>
            
              <a class="dropdown-item" href="/slides/08_Survival"><span>Survival modelling in HTA</span></a>
            
              <a class="dropdown-item" href="/slides/09_MM"><span>Markov models</span></a>
            
              <a class="dropdown-item" href="/slides/10_Missing"><span>Missing data in HTA</span></a>
            
              <a class="dropdown-item" href="/slides/11_VoI"><span>Introduction to Value of information</span></a>
            
              <a class="dropdown-item" href="/slides/12_EVPPI"><span>Expected value of partial information</span></a>
            
              <a class="dropdown-item" href="/slides/13_EVSI"><span>Expected value of sample information</span></a>
            
              <a class="dropdown-item" href="/syllabus/lecture14/14_Data_EVSI.pdf"><span>Generating data for the analysis of the EVSI</span></a>
            
              <a class="dropdown-item" href="/syllabus/lecture15/15_EVSI_MC.pdf"><span>Calculating expected value of sample information</span></a>
            
              <a class="dropdown-item" href="/syllabus/lecture16/16_EVSI_regression.pdf"><span>Regression-based EVSI</span></a>
            
          </div>
        </li>

        
        

        
        <li class="nav-item dropdown">
          <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>Practicals</span><span class="caret"></span>
          </a>
          <div class="dropdown-menu">
            
              <a class="dropdown-item" href="/practical/01_monte-carlo"><span>Monte Carlo</span></a>
            
              <a class="dropdown-item" href="/practical/02_mcmc"><span>MCMC</span></a>
            
              <a class="dropdown-item" href="/practical/03_bcea"><span>Cost-effectiveness analysis</span></a>
            
              <a class="dropdown-item" href="/practical/04_ild"><span>HTA with individual level data</span></a>
            
              <a class="dropdown-item" href="/practical/05_ald"><span>Evidence synthesis and decision models</span></a>
            
              <a class="dropdown-item" href="/practical/06_nma"><span>NMA</span></a>
            
              <a class="dropdown-item" href="/practical/07_structural"><span>PSA to structural uncertainty</span></a>
            
              <a class="dropdown-item" href="/practical/08_survival"><span>Survival analysis</span></a>
            
              <a class="dropdown-item" href="/practical/09_mm"><span>Markov and multistate models</span></a>
            
              <a class="dropdown-item" href="/practical/10_missing"><span>Missing data</span></a>
            
              <a class="dropdown-item" href="/practical/11_intro_voi"><span>Computing the EVPI using Monte Carlo</span></a>
            
              <a class="dropdown-item" href="/practical/12_evppi"><span>Computing the EVPPI in BCEA and SAVI</span></a>
            
              <a class="dropdown-item" href="/practical/13_data_evsi"><span>Generating data for the EVSI</span></a>
            
              <a class="dropdown-item" href="/practical/14_evsi_mc"><span>Computing the EVSI using Monte Carlo</span></a>
            
              <a class="dropdown-item" href="/practical/15_evsi_regression"><span>Computing the EVSI using regression</span></a>
            
          </div>
        </li>

        
        

        
        <li class="nav-item dropdown">
          <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>Instructions</span><span class="caret"></span>
          </a>
          <div class="dropdown-menu">
            
              <a class="dropdown-item" href="/tips/computer-specification"><span>Computer specification</span></a>
            
              <a class="dropdown-item" href="/tips/using-bugs"><span>Using BUGS</span></a>
            
          </div>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/publication"><span>Reading list</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#people"><span>People</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

      
      
        
      
        
      
        
      
        
      

      
      

      
      

      
      

    </ul>

  </div>
</nav>


  </div>

  <div class="page-body">
    

<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      <form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <div class="d-flex">
      <span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">
        
          7. PSA to structural uncertainty
        
      </span>
      <span><i class="fas fa-chevron-down"></i></span>
    </div>
  </button>

  
</form>

<nav class="collapse docs-links" id="docs-nav">
  
  
  
  
  
  

  
  
    

    
      

      


  
    
    
    
    
      
    
    

    
      <ul class="nav docs-sidenav">
        <li class=""><a href="/practical/"></a></li>
    
      


  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/practical/01_monte-carlo/">1. Monte Carlo</a>
    
      
        <ul class="nav docs-sidenav">
      


  <li class=""><a href="/practical/01_monte-carlo/solutions/">Solutions</a></li>

      
        </ul>
      
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/practical/02_mcmc/">2. MCMC</a>
    
      
        <ul class="nav docs-sidenav">
      


  <li class=""><a href="/practical/02_mcmc/solutions/">Solutions</a></li>



  <li class=""><a href="/practical/02_mcmc/covid/">Covid</a></li>



  <li class=""><a href="/practical/02_mcmc/tutorial/">MCMC Tutorial</a></li>

      
        </ul>
      
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/practical/03_bcea/">3. Intro-HE</a>
    
      
        <ul class="nav docs-sidenav">
      


  <li class=""><a href="/practical/03_bcea/solutions/">Solution</a></li>

      
        </ul>
      
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/practical/04_ild/">4. ILD</a>
    
      
        <ul class="nav docs-sidenav">
      


  <li class=""><a href="/practical/04_ild/tutorial-regression/">Regression Tutorial</a></li>



  <li class=""><a href="/practical/04_ild/solutions/">Solutions</a></li>

      
        </ul>
      
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/practical/05_ald/">5. ALD</a>
    
      
        <ul class="nav docs-sidenav">
      


  <li class=""><a href="/practical/05_ald/solutions/">Solutions</a></li>

      
        </ul>
      
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/practical/06_nma/">6. NMA</a>
    
      
        <ul class="nav docs-sidenav">
      


  <li class=""><a href="/practical/06_nma/solutions/">Solutions</a></li>

      
        </ul>
      
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/practical/07_structural/">7. PSA to structural uncertainty</a>
    
      
        <ul class="nav docs-sidenav">
      


  <li class="active"><a href="/practical/07_structural/solutions/">Solutions</a></li>

      
        </ul>
      
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/practical/08_survival/">8. Survival</a>
    
      
        <ul class="nav docs-sidenav">
      


  <li class=""><a href="/practical/08_survival/solutions/">Solutions</a></li>

      
        </ul>
      
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/practical/09_mm/">9. Markov models</a>
    
      
        <ul class="nav docs-sidenav">
      


  <li class=""><a href="/practical/09_mm/solutions/">Solutions</a></li>



  <li class=""><a href="/practical/09_mm/cohort-model/">Cohort discrete Markov model</a></li>

      
        </ul>
      
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/practical/10_missing/">10. Missing data</a>
    
      
        <ul class="nav docs-sidenav">
      


  <li class=""><a href="/practical/10_missing/solutions/">Solutions</a></li>

      
        </ul>
      
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/practical/11_intro_voi/">11. EVPI using MC</a>
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/practical/12_evppi/">12. EVPPI in BCEA &amp; SAVI</a>
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/practical/13_data_evsi/">13 Generating data for EVSI</a>
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/practical/14_evsi_mc/">14. EVSI using MC</a>
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/practical/15_evsi_regression/">15. EVSI using regression</a>
    

    
      </div>
    

      
    

    
      </ul>
    

  
</nav>
    </div>

    <main class="col-10 docs-content" role="main">
      <article class="article">

        <div class="docs-article-container">
          <h1>Practical 7. PSA to structural uncertainty — SOLUTIONS</h1>
          
          
          
          
          




<div class="btn-links mb-3">
  
  








  


















  
  
  
    
  
  
  
  
  
    
    
      
    
  
  <a class="btn btn-outline-primary btn-page-header" href="/slides/07_Model_uncertainty" >
    Lecture 7</a>

  
  
  
    
  
  
  
  
  
    
    
      
    
  
  <a class="btn btn-outline-primary btn-page-header" href="/practical/07_structural/practical7.pdf" >
    <i class="fas fa-file-pdf mr-1"></i>PDF version</a>


</div>


          <br>
          
          <div class="article-style">
            


<p>The first thing we do is loading and analysing the “base-case” model, which is stored in the object <code>statins_base.Rdata</code> and the “robust” version of the model, stored in <code>statins_HC.Rdata</code>.</p>
<pre class="r"><code>library(BCEA)
library(R2OpenBUGS)
load(&quot;statins_base.Rdata&quot;)
load(&quot;statins_HC.Rdata&quot;)</code></pre>
<p>We can use the <code>R</code> function <code>print</code> to visualise the output for the two models, for example as in the following.</p>
<pre class="r"><code>print(statins_base)</code></pre>
<p>The output to this call is a long list of summary statistics — it is also possible to visualise an excerpt by using code such as the following</p>
<pre class="r"><code>head(statins_base$summary[,c(&quot;mean&quot;,&quot;sd&quot;,&quot;2.5%&quot;,&quot;97.5%&quot;,&quot;Rhat&quot;,&quot;n.eff&quot;)],n=15)</code></pre>
<pre><code>                 mean       sd      2.5%     97.5%     Rhat n.eff
cost.hosp[1] 238.7010 137.0428  91.68029  482.0066 1.001533   980
cost.hosp[2] 315.6340 168.7579 124.20521  668.4667 1.002554  1000
cost.hosp[3] 523.0695 451.0165 144.02705 1357.9918 1.002820  1000
cost.hosp[4] 424.9861 232.1917 170.08732  877.9484 1.001743   980
cost.hosp[5] 305.1978 172.3249 120.79156  656.3935 1.002747   550
cost.hosp[6] 301.1282 163.4569 121.85935  618.0017 1.001342  1000
cost.stat[1] 480.8821 289.1621 137.50194 1232.7586 1.004167   360
cost.stat[2] 350.0194 201.6103 103.42871  871.5393 1.000252  1000
cost.stat[3] 166.6851 125.6502  34.24849  498.3156 1.000219  1000
cost.stat[4] 305.4061 261.7113  47.69648 1008.5598 1.004566  1000
cost.stat[5] 346.9371 209.6277 103.21293  880.0139 1.006177   400
cost.stat[6] 165.0717 129.7352  35.28509  526.9310 1.000074  1000
cost.tot[1]  719.5831 324.8498 309.13357 1526.9058 1.005610   270
cost.tot[2]  665.6534 265.4862 331.33786 1357.5038 1.001748  1000
cost.tot[3]  689.7546 467.3877 242.54283 1629.7467 1.002190  1000</code></pre>
<p>which produces the first <code>n=15</code> rows (i.e. parameters) for the whole summary table. In particular, we only select the columns headed as <code>"mean"</code>, <code>"sd"</code>, etc. (we do so to exclude additional quantiles that are automatically stored in the object <code>statins_base$summary</code>). We should make sure that the models have all converged and that autocorrelation is not an issue (by e.g. analysing the <span class="math inline">\(\hat{R}\)</span> and <span class="math inline">\(n_{eff}\)</span> statistics).</p>
<p>We can already check the DIC associated with each of the two models, to get some ideas of which one will be given most weight in the structural PSA. We can do so by using the following command.</p>
<pre class="r"><code># Displays the DIC for the two models
c(statins_base$DIC,statins_HC$DIC)</code></pre>
<pre><code>[1] 2233.875 2225.988</code></pre>
<p>As is easy to see, the “robust” model is associated with a relatively lower DIC (by over 10 points).</p>
<p>We can now move on and use the results from the two Bayesian models as inputs to <code>BCEA</code>. The objects <code>statins_base$sims.list</code> and <code>statins_HC$sims.list</code> contain the simulated values for all the model parameters monitored in <code>list</code> format. We can follow the script and use the code</p>
<pre class="r"><code># Defines the intervention labels
interventions &lt;- c(&quot;Atorvastatin&quot;,&quot;Fluvastatin&quot;,&quot;Lovastatin&quot;,&quot;Pravastatin&quot;,
                   &quot;Rosuvastatin&quot;,&quot;Simvastatin&quot;)
# BCEA object with the economic analysis of the &quot;base case&quot; model
m1 &lt;- bcea(statins_base$sims.list$effect,statins_base$sims.list$cost.tot,
           ref=1,interventions=interventions)
# BCEA object with the economic analysis of the Half-Cauchy model
m2 &lt;- bcea(statins_HC$sims.list$effect,statins_HC$sims.list$cost.tot,
           ref=1,interventions=interventions)</code></pre>
<p>to first define a vector of intervention labels and then apply the function <code>bcea</code> to the suitable variables of effects and costs in the two models.</p>
<p>The two objects <code>m1</code> and <code>m2</code> can be post-processed as any <code>BCEA</code> objects (e.g. using <code>plot</code> or <code>print</code> methods). But in addition to this, we can also combine them to perform the PSA to structural assumptions. To do so, we need to manipulate the original objects in a suitable way. Firstly, we need to create a <code>list</code> of models, which we can simply do using the following command.</p>
<pre class="r"><code># Combines the BUGS models
models &lt;- list(statins_base,statins_HC)</code></pre>
<p>the newly created object contains the information from the two <code>BUGS</code> models. We can also create suitable lists in which we store the relevant variables of effectiveness and costs from the two models, for example using code such as the following.</p>
<pre class="r"><code># Creates the variables of effectiveness and costs
effects &lt;- list(statins_base$sims.list$effect, statins_HC$sims.list$effect)
costs &lt;- list(statins_base$sims.list$cost.tot, statins_HC$sims.list$cost.tot)</code></pre>
<p>Finally, we can feed these inputs to the <code>BCEA</code> function <code>struct.psa</code> as in the following.</p>
<pre class="r"><code># Finally uses BCEA to perform the structural PSA to consider the base and HC models
m3 &lt;- struct.psa(models,effects,costs,ref=1,interventions=interventions)</code></pre>
<p><code>struct.psa</code> takes as basic arguments three lists, containing the <code>BUGS</code> models, the list of effects and the list of costs simulations and combines them to compute the model weights (based on the DICs).</p>
<p>The object <code>m3</code> is a <code>list</code>, which contains 3 elements:</p>
<pre class="r"><code>lapply(m3,function(x) list(class(x),names(x))) </code></pre>
<pre><code>$he
$he[[1]]
[1] &quot;bcea&quot; &quot;list&quot;

$he[[2]]
 [1] &quot;n_sim&quot;         &quot;n_comparators&quot; &quot;n_comparisons&quot; &quot;delta_e&quot;      
 [5] &quot;delta_c&quot;       &quot;ICER&quot;          &quot;Kmax&quot;          &quot;k&quot;            
 [9] &quot;ceac&quot;          &quot;ib&quot;            &quot;eib&quot;           &quot;kstar&quot;        
[13] &quot;best&quot;          &quot;U&quot;             &quot;vi&quot;            &quot;Ustar&quot;        
[17] &quot;ol&quot;            &quot;evi&quot;           &quot;ref&quot;           &quot;comp&quot;         
[21] &quot;step&quot;          &quot;interventions&quot; &quot;e&quot;             &quot;c&quot;            


$w
$w[[1]]
[1] &quot;numeric&quot;

$w[[2]]
NULL


$DIC
$DIC[[1]]
[1] &quot;numeric&quot;

$DIC[[2]]
NULL</code></pre>
<p>The <code>R</code> function <code>lapply</code> applies iteratively the function <code>class</code> and <code>names</code> to each element of the object <code>m3</code>.</p>
<p>As is possible to see, the first one, named <code>he</code>, is an object in the class <code>BCEA</code> and so it contains the usual elements that such objects do (e.g. <code>n.sim</code>, <code>n.comparators</code>, etc). The elements <code>w</code> and <code>DIC</code> are numeric vectors and include the weights and the value of the DIC associated with each individual models. We can visualise for example the weights by using the command,</p>
<pre class="r"><code>print(m3$w)</code></pre>
<pre><code>[1] 0.01901127 0.98098873</code></pre>
<p>which indicates that the second model (the “robust” Half-Cauchy) is given a weight of over 98%. This is consistent with the fact that its DIC is lower than the one for the base case model, which in turn indicates better fit.</p>
<p>We can also use all the methods implemented for <code>BCEA</code> objects to analyse and visualise the output of the model averaging. For example, we can summarise the cost-effectiveness analysis by typing</p>
<pre class="r"><code>summary(m3$he)</code></pre>
<pre><code>
Cost-effectiveness analysis summary 

Reference intervention:  Atorvastatin
Comparator intervention(s): Fluvastatin
                          : Lovastatin
                          : Pravastatin
                          : Rosuvastatin
                          : Simvastatin

Optimal decision: choose Simvastatin for k &lt;  and  for k &gt;= 


Analysis for willingness to pay parameter k = 25000

             Expected utility
Atorvastatin            22823
Fluvastatin             22435
Lovastatin              21381
Pravastatin             21731
Rosuvastatin            22526
Simvastatin             22738

                                  EIB  CEAC     ICER
Atorvastatin vs Fluvastatin   388.695 0.768  3919.60
Atorvastatin vs Lovastatin   1442.154 0.843  1432.44
Atorvastatin vs Pravastatin  1092.152 0.958   336.72
Atorvastatin vs Rosuvastatin  297.304 0.738  5227.07
Atorvastatin vs Simvastatin    85.002 0.594 19129.49

Optimal intervention (max expected utility) for k = 25000: Atorvastatin
           
EVPI 193.22</code></pre>
<p>and we could plot the cost-effectiveness plane with the following command.</p>
<pre class="r"><code>ceplane.plot(m3$he)</code></pre>
<p><img src="/practical/07_structural/solutions_files/figure-html/unnamed-chunk-5-1.png" width="70%" style="display: block; margin: auto;" />
or generate multiple treatments comparison cost-effectiveness acceptability curves with the following commands.</p>
<pre class="r"><code>m3.multi&lt;-multi.ce(m3$he)
ceac.plot(m3.multi)</code></pre>
<p><img src="/practical/07_structural/solutions_files/figure-html/unnamed-chunk-6-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Notice that because <em>in this particular case</em> one of the models is effectively given an almost 100% weight, the model average will resemble it almost identically.</p>

          </div>

          



          
          
          <div class="article-widget">
            
<div class="post-nav">
  
  
</div>

          </div>
          
        </div>

        <div class="body-footer">
          
          

          


          
          
          
          
          


          




          




        </div>

      </article>

      <footer class="site-footer">
  

  <p class="powered-by">
    
    
      &copy;  2022-2024 &middot;

    Based on
    <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a>
    
    
    (version 5.3.0)
    
    for <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a> &middot;
    
    
    <i><b>Latest update: 24 Jun 2022 </i></b>
    

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>

</footer>


    </main>
  </div>
</div>

  </div>

  <div class="page-footer">
    
    
  </div>

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      

    
    <script src="/js/vendor-bundle.min.b73dfaac3b6499dc997741748a7c3fe2.js"></script>

    
    
    
      
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      

      
      

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js" integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin="anonymous"></script>
        
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js" crossorigin="anonymous"></script>
        
      

    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.js" integrity="sha512-SeiQaaDh73yrb56sTW/RgVdi/mMqNeM2oBwubFHagc5BkixSpP1fvqF47mKzPGWYSSy4RwbBunrJBQ4Co8fRWA==" crossorigin="anonymous"></script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.2/anchor.min.js" integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    
    
    

    
    

    
    
    
    

    
    

    
    
    
    
    
    
    
    
    
    <script src="/en/js/wowchemy.min.50d3bf3df0c53b31631bb48a62b35f92.js"></script>

    






</body>
</html>
